# Local Development Environment Configuration

# Environment
export ENVIRONMENT=dev

# Server Configuration
export WEB_PORT=59000

# MailChannels API (required for sending emails)
export MAILCHANNELS_API_KEY=your_key

# Optional DKIM configuration for better deliverability
export DKIM_SELECTOR=selector1
export DKIM_PRIVATE_KEY=base64_encoded_private_key
export DKIM_DOMAIN=yourdomain.com

# Optional tuning
export EMAIL_PROCESSOR_INTERVAL_SECS=30  # default
export EMAIL_BATCH_SIZE=10               # default

# Stripe Payment Configuration (optional - required for credit card payments)
# Get keys from: https://dashboard.stripe.com/apikeys
# Use TEST keys (pk_test_... and sk_test_...) for development
# Use LIVE keys (pk_live_... and sk_live_...) for production
export STRIPE_SECRET_KEY=sk_test_your_secret_key_here
export STRIPE_PUBLISHABLE_KEY=pk_test_your_publishable_key_here

# Stripe Webhook Secret (required for production webhooks)
# For local testing, use the test value: whsec_test_secret
# For production, get from: https://dashboard.stripe.com/webhooks
export STRIPE_WEBHOOK_SECRET=whsec_test_secret

# ICPay Configuration (optional - required for crypto payments)
# Get keys from: https://icpay.org (Dashboard → Settings → API Keys)
# ICPay uses two keys (same pattern as Stripe):
#   - Publishable Key: for frontend (public, starts with pk_)
#   - Secret Key: for backend (private, starts with sk_)
export ICPAY_SECRET_KEY=sk_your_icpay_secret_key_here
export ICPAY_PUBLISHABLE_KEY=pk_your_icpay_publishable_key_here
# Note: Frontend key must be set at WEBSITE BUILD TIME (not runtime):
#   1. Set VITE_ICPAY_PUBLISHABLE_KEY in website/.env.production
#   2. Run: cd website && npm run build
#   3. Deploy the built website to Docker

# ============================================
# Chatwoot Configuration (Required)
# ============================================
# Generate secrets with: openssl rand -hex 64 (for SECRET_KEY_BASE)
#                        openssl rand -hex 32 (for HMAC_SECRET, POSTGRES_PASSWORD)
export CHATWOOT_SECRET_KEY_BASE=your_64_byte_hex_secret
export CHATWOOT_HMAC_SECRET=your_32_byte_hex_secret
export CHATWOOT_POSTGRES_PASSWORD=your_secure_password

# Get these from Chatwoot admin panel after first setup:
# 1. Create super admin: docker compose exec chatwoot-web bundle exec rails console
#    > SuperAdmin.create!(email: 'admin@decent-cloud.org', password: 'secure')
# 2. Log in to Chatwoot, create Account, create API inbox
# 3. Get API access token from Profile → Access Token
# 4. Get Account ID from URL (e.g., /app/accounts/1/...)
# 5. Get Inbox ID from Inbox settings
# 6. Get Website Token from Inbox → Configuration → Website Token
# 7. Create Platform App: SuperAdmin → Platform Apps → New → copy access token
export CHATWOOT_API_TOKEN=your_api_access_token
export CHATWOOT_ACCOUNT_ID=1
export CHATWOOT_INBOX_ID=1
# Platform API token for user management (password resets, etc.)
# Required for provider support portal access
export CHATWOOT_PLATFORM_API_TOKEN=your_platform_app_access_token
# Frontend widget token (set during website build via VITE_CHATWOOT_WEBSITE_TOKEN)
export CHATWOOT_WEBSITE_TOKEN=your_website_token
export CHATWOOT_BASE_URL=https://support.decent-cloud.org

# Optional: Chatwoot frontend URL (defaults to support.decent-cloud.org)
# export CHATWOOT_FRONTEND_URL=https://support.decent-cloud.org

# Optional: SMTP for Chatwoot email notifications
# export SMTP_ADDRESS=smtp.example.com
# export SMTP_PORT=587
# export SMTP_USERNAME=your_smtp_user
# export SMTP_PASSWORD=your_smtp_password

# =============================================================================
# AI Bot Service (required for auto-responses)
# =============================================================================
# Claude API (for answer generation) - Get key from: https://console.anthropic.com/
export LLM_API_KEY=sk-ant-...
#export LLM_API_URL=https://api.anthropic.com/v1/messages  # default
#export LLM_API_MODEL=claude-sonnet-4-5-20250514

# OpenAI API (optional - for Chatwoot AI features and semantic search embeddings)
# Get key from: https://platform.openai.com/api-keys
# Uses text-embedding-3-small model. Falls back to keyword search if not set.
#export OPENAI_API_KEY=sk-...

# =============================================================================
# Provider Notifications
# =============================================================================

# Default user to notify for general inquiries (no contract)
# This user must have notification config set up (telegram/email/sms)
#export DEFAULT_ESCALATION_USER=support_admin

# Telegram Bot (for escalation alerts)
# 1. Create bot via @BotFather on Telegram
# 2. Get token like: 123456789:ABCdefGHIjklMNO-pqrSTUvwxYZ
# 3. Provider sets their chat_id via /api/v1/providers/me/notification-config
export TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNO-pqrSTUvwxYZ
# Bot username for website UI (without @). Dev: DecentCloudDevBot, Prod: DecentCloudBot
export TELEGRAM_BOT_USERNAME=DecentCloudBot

# Twilio SMS (for SMS notifications)
# Get credentials from: https://console.twilio.com/
#export TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
#export TWILIO_AUTH_TOKEN=your_auth_token
#export TWILIO_PHONE_NUMBER=+15551234567

# =============================================================================
# API Configuration
# =============================================================================
# Public URL of the API (required for Chatwoot Agent Bot auto-registration)
# This URL must be accessible from the Chatwoot server
# Dev: https://dev-api.decent-cloud.org
# Prod: https://api.decent-cloud.org
export API_PUBLIC_URL=https://dev-api.decent-cloud.org
